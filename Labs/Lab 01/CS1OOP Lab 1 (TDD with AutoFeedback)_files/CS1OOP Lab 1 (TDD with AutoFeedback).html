<!DOCTYPE html>
<!-- saved from url=(0163)https://vle.aston.ac.uk/bbcswebdav/pid-2151616-dt-content-rid-14503049_1/courses/2020_CS1OOP_P1_P2/TP2/week01-tdd-autofeedback/cs1oop-tdd-autofeedback/index.html#0 -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <meta name="theme-color" content="#4F7DC9">
  
  <title>CS1OOP Lab 1 (TDD with AutoFeedback)</title>
  <link rel="stylesheet" href="./CS1OOP Lab 1 (TDD with AutoFeedback)_files/css">
  <link rel="stylesheet" href="./CS1OOP Lab 1 (TDD with AutoFeedback)_files/icon">
  <link rel="stylesheet" href="./CS1OOP Lab 1 (TDD with AutoFeedback)_files/codelab-elements.css">
  <style>
    .success {
      color: #1e8e3e;
    }
    .error {
      color: red;
    }
  </style>
<script src="./CS1OOP Lab 1 (TDD with AutoFeedback)_files/analytics.js.download"></script></head>
<body>
  <google-codelab-analytics gaid="UA-49880327-14" environment="web" category="null"></google-codelab-analytics>
  <google-codelab codelab-gaid="" id="cs1oop-tdd-autofeedback" environment="web" feedback-link="mailto:a.garcia-dominguez@aston.ac.uk" selected="0" google-codelab-ready="" codelab-title="CS1OOP Lab 1 (TDD with AutoFeedback)" anayltics-ready="anayltics-ready"><div id="drawer"><div class="codelab-time-container" style="display: none;"></div><div class="steps"><ol><li completed="" selected=""><a href="https://vle.aston.ac.uk/bbcswebdav/pid-2151616-dt-content-rid-14503049_1/courses/2020_CS1OOP_P1_P2/TP2/week01-tdd-autofeedback/cs1oop-tdd-autofeedback/index.html#0"><span class="step"><span>Preparing your environment</span></span></a></li><li><a href="https://vle.aston.ac.uk/bbcswebdav/pid-2151616-dt-content-rid-14503049_1/courses/2020_CS1OOP_P1_P2/TP2/week01-tdd-autofeedback/cs1oop-tdd-autofeedback/index.html#1"><span class="step"><span>Importing the project</span></span></a></li><li><a href="https://vle.aston.ac.uk/bbcswebdav/pid-2151616-dt-content-rid-14503049_1/courses/2020_CS1OOP_P1_P2/TP2/week01-tdd-autofeedback/cs1oop-tdd-autofeedback/index.html#2"><span class="step"><span>Examining the code</span></span></a></li><li><a href="https://vle.aston.ac.uk/bbcswebdav/pid-2151616-dt-content-rid-14503049_1/courses/2020_CS1OOP_P1_P2/TP2/week01-tdd-autofeedback/cs1oop-tdd-autofeedback/index.html#3"><span class="step"><span>Your first test</span></span></a></li><li><a href="https://vle.aston.ac.uk/bbcswebdav/pid-2151616-dt-content-rid-14503049_1/courses/2020_CS1OOP_P1_P2/TP2/week01-tdd-autofeedback/cs1oop-tdd-autofeedback/index.html#4"><span class="step"><span>Testing a bad input</span></span></a></li><li><a href="https://vle.aston.ac.uk/bbcswebdav/pid-2151616-dt-content-rid-14503049_1/courses/2020_CS1OOP_P1_P2/TP2/week01-tdd-autofeedback/cs1oop-tdd-autofeedback/index.html#5"><span class="step"><span>Avoiding double-booking</span></span></a></li><li><a href="https://vle.aston.ac.uk/bbcswebdav/pid-2151616-dt-content-rid-14503049_1/courses/2020_CS1OOP_P1_P2/TP2/week01-tdd-autofeedback/cs1oop-tdd-autofeedback/index.html#6"><span class="step"><span>Multiple-hour appointments</span></span></a></li><li><a href="https://vle.aston.ac.uk/bbcswebdav/pid-2151616-dt-content-rid-14503049_1/courses/2020_CS1OOP_P1_P2/TP2/week01-tdd-autofeedback/cs1oop-tdd-autofeedback/index.html#7"><span class="step"><span>Submitting to AutoFeedback and Blackboard</span></span></a></li></ol></div><div class="metadata"><a target="_blank" href="mailto:a.garcia-dominguez@aston.ac.uk"><i class="material-icons">bug_report</i> Report a mistake</a></div></div><div id="codelab-title"><div id="codelab-nav-buttons"><a href="https://vle.aston.ac.uk/" id="arrow-back"><i class="material-icons">close</i></a><a href="https://vle.aston.ac.uk/bbcswebdav/pid-2151616-dt-content-rid-14503049_1/courses/2020_CS1OOP_P1_P2/TP2/week01-tdd-autofeedback/cs1oop-tdd-autofeedback/index.html#" id="menu"><i class="material-icons">menu</i></a></div><h1 is-upgraded="" class="title">CS1OOP Lab 1 (TDD with AutoFeedback)</h1><div class="codelab-time-container" style="display: none;"></div><devsite-user></devsite-user></div><div id="main"><div id="steps"><google-codelab-step label="Preparing your environment" duration="0" step="1" style="transform: translate3d(0px, 0px, 0px);" selected=""><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">1. Preparing your environment</h2>
        <p>This lab requires Java 11 or newer, and a recent installation of <a href="https://www.eclipse.org/downloads/packages/release/2020-12/r/eclipse-ide-java-developers" target="_blank">Eclipse for Java Developers</a>.</p>
<h2 is-upgraded="">Using a lab computer?</h2>
<p>If you are using a lab computer or a student VDI machine, launch Eclipse 2019-06 through AstonApps (you will need to launch Java 11.0.5 first). Eclipse will start on its default workspace, which already has all dependencies set up. Eclipse should ask you to pick a workspace folder: you should pick a folder in your home drive (e.g. <code>H:\CS1OOP\eclipse</code>), so your projects are created inside that folder and are preserved after you turn off the lab PC.</p>


      </div></div></google-codelab-step><google-codelab-step label="Importing the project" duration="0" step="2" style="transform: translate3d(-110%, 0px, 0px);"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">2. Importing the project</h2>
        <p>Download the starting code from Blackboard. You don't need to unpack the <code>.zip</code> file.</p>
<p>Import the project by selecting "File - Import...", and then selecting "General - Existing Projects into Workspace" in the new window:</p>
<p class="image-container"><img alt="Import dialog" src="./CS1OOP Lab 1 (TDD with AutoFeedback)_files/ae0bf83bfdaf556f.png"></p>
<p>Select "Next", then pick "Archive file" and "Browse" to select the <code>.zip</code> file you downloaded.</p>
<p>One project called <code>uk.ac.aston.oop.calendar</code> should come up. Press OK to import this project.</p>
<p>Make sure the project is imported as expected. It may take a few seconds to download the project dependencies from the Internet. After that, it should look like in the lecture slides (but named <code>calendar</code> instead of <code>calendar-starting</code>):</p>
<p class="image-container"><img alt="Imported project" src="./CS1OOP Lab 1 (TDD with AutoFeedback)_files/a72d238d26778182.png"></p>
<ul>
<li>It should show up in the "Package Explorer" as a blue folder with an "M" (for Maven) and a "J" (for Java) on top of it.</li>
<li>It should list a JRE System Library (will be JavaSE-11 or newer).</li>
<li>It should list a set of "Maven Dependencies", containing the classes from the JUnit testing framework that we will need for this lab.</li>
<li>There should be two source folders (yellow folders with crosshairs inside them): <code>src</code> (for the code of the main program) and <code>src-test</code> (for test code).</li>
<li>There will be two more files: <code>pom.xml</code> (used by Maven: do not change it) and <code>Submit to AutoFeedback.launch</code> (which we will discuss later).</li>
</ul>


      </div></div></google-codelab-step><google-codelab-step label="Examining the code" duration="0" step="3" style="transform: translate3d(-110%, 0px, 0px);"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">3. Examining the code</h2>
        <p>Before you start, always do a quick skim over the code. You will find there are three classes.</p>
<ul>
<li><code>Appointment</code> represents a single appointment in a <code>Day</code>: it has a description and a duration in hours. It has a constructor to create instances of it, and two getter methods to fetch the description and the duration.</li>
<li><code>Day</code> is the class you will be working on. It represents a single day in the calendar, where appointments can be made. It has a constructor, a <code>makeAppointment</code> function to make appointments (which returns <code>true</code> on success and <code>false</code> on failure), a <code>getAppointment</code> function to get the appointment for a specific time (if there is any), a getter to fetch the day number, and a <code>validTime</code> function which returns <code>true</code> for times where appointments can be made.</li>
<li><code>DayTest</code> is a JUnit test class, where you will be adding your tests.</li>
</ul>
<p>You will notice that the <code>Day.makeAppointment</code> function is incomplete, and that the <code>DayTest</code> class is empty. In this lab, you will be completing both. Do not change any other part of the code (particularly, do not change <code>Day.getAppointment</code>).</p>


      </div></div></google-codelab-step><google-codelab-step label="Your first test" duration="0" step="4" style="transform: translate3d(-110%, 0px, 0px);"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">4. Your first test</h2>
        <p>Rather than directly write the body of <code>makeAppointment</code>, we will write a test to specify how it should work. Once we verify that <code>makeAppointment</code> needs more work, then we will put in enough code to pass the test. We will repeat this until we have covered all the cases we can think of: this approach is known as <em>test-driven development</em>.</p>
<h2 is-upgraded="">Writing the test</h2>
<p>Go to the <code>DayTest</code> class, and add a test method called <code>appointmentStartOfDay</code>. Keep in mind that a "method" is another name for a function inside a class. Test methods can be called by anyone (<code>public</code>), they do not return anything (<code>void</code>), and they have the <code>@Test</code> annotation before the <code>public</code> keyword to tell JUnit that they are tests. This means it will look like this at first:</p>
<pre><code><span class="lit">@Test</span><span class="pln"> </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> appointmentStartOfDay</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

</span><span class="pun">}</span></code></pre>
<p>Write the body of <code>appointmentStartOfDay</code>: remember the structure of "Arrange, Act, Assert" from the lecture slides. In this test, we will check that <code>makeAppointment</code> can make a 1-hour appointment at the start of the day, and that this is returned appropriately by <code>getAppointment</code>. You can try to write the code by yourself and then come back to this section, or you can follow the step-by-step instructions below for this first test. We will be giving fewer instructions in the next sections.</p>
<p>As part of the "Arrange" part, we need to set up any objects we need for the test. In this case, we need a <code>Day</code> object and a 1-hour appointment:</p>
<pre><code><span class="com">// Exact day number does not matter</span><span class="pln">
</span><span class="typ">Day</span><span class="pln"> day </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Day</span><span class="pun">(</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
</span><span class="com">// Description does not matter</span><span class="pln">
</span><span class="typ">Appointment</span><span class="pln"> app </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Appointment</span><span class="pun">(</span><span class="str">"meeting"</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span></code></pre>
<p>We are done with "Arrange", and now we go into "Act", where we exercise the code we want to test. We want to make an appointment, and we want to retrieve the appointment from the Day (to see if it was registered properly later):</p>
<pre><code><span class="kwd">boolean</span><span class="pln"> success </span><span class="pun">=</span><span class="pln"> day</span><span class="pun">.</span><span class="pln">makeAppointment</span><span class="pun">(</span><span class="typ">Day</span><span class="pun">.</span><span class="pln">START_OF_DAY</span><span class="pun">,</span><span class="pln"> app</span><span class="pun">);</span><span class="pln">
</span><span class="typ">Appointment</span><span class="pln"> fetched </span><span class="pun">=</span><span class="pln"> day</span><span class="pun">.</span><span class="pln">getAppointment</span><span class="pun">(</span><span class="typ">Day</span><span class="pun">.</span><span class="pln">START_OF_DAY</span><span class="pun">);</span></code></pre>
<p>Next, we go into the "Assert" part where we check if the "Act" part worked as we expected. The appointment should have been made successfully, and we should be getting back the appointment we put in.</p>
<pre><code><span class="pln">assertTrue</span><span class="pun">(</span><span class="pln">success</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Making an appointment at the start of a new day should work"</span><span class="pun">);</span><span class="pln">
assertSame</span><span class="pun">(</span><span class="pln">app</span><span class="pun">,</span><span class="pln"> fetched</span><span class="pun">,</span><span class="pln"> </span><span class="str">"It should be possible to fetch the appointment we just made"</span><span class="pun">);</span></code></pre>
<p>The first line checks that <code>success</code> is <code>true</code> as we expected: the second argument describes our expectation in English, and it is helpful when the test fails. Keep in mind that we could have used <code>assertEquals(true, success, "expectation")</code>, but <code>assertTrue</code> is more concise in this case.</p>
<p>The second line checks that the <code>Appointment</code> we got from <code>Day</code> when we asked it for the appointment at the start of the day is <em>exactly the same object</em> as the one in <code>app</code>. This is different from <code>assertEquals(app, fetched, "expectation")</code>, which would check if the two variables have <em>equivalent</em> objects rather than exactly the same object. We will discuss this concept later in the module.</p>
<p>If you get compilation errors saying that <code>assertTrue</code> or <code>assertSame</code> cannot be found, make sure you import them from JUnit at the top of the file, like this:</p>
<pre><code><span class="kwd">import</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> org</span><span class="pun">.</span><span class="pln">junit</span><span class="pun">.</span><span class="pln">jupiter</span><span class="pun">.</span><span class="pln">api</span><span class="pun">.</span><span class="typ">Assertions</span><span class="pun">.</span><span class="pln">assertSame</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> org</span><span class="pun">.</span><span class="pln">junit</span><span class="pun">.</span><span class="pln">jupiter</span><span class="pun">.</span><span class="pln">api</span><span class="pun">.</span><span class="typ">Assertions</span><span class="pun">.</span><span class="pln">assertTrue</span><span class="pun">;</span></code></pre>
<h2 is-upgraded="">First run of the test</h2>
<p>Now, try to run the test by right-clicking on your project and selecting "Run As - JUnit Test". You will find that the test does not pass: you get a red bar, and there is a blue mark next to "appointmentStartOfDay". Don't panic: this is part of the process!</p>
<p>Check the "Failure Trace": you may have to scroll to the right to see the error message. It should have something like this:</p>
<pre><code><span class="pln">org</span><span class="pun">.</span><span class="pln">opentest4j</span><span class="pun">.</span><span class="typ">AssertionFailedError</span><span class="pun">:</span><span class="pln"> </span><span class="typ">It</span><span class="pln"> should be possible to fetch the appointment we just made </span><span class="pun">==&gt;</span><span class="pln"> expected</span><span class="pun">:</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">uk</span><span class="pun">.</span><span class="pln">ac</span><span class="pun">.</span><span class="pln">aston</span><span class="pun">.</span><span class="pln">oop</span><span class="pun">.</span><span class="pln">calendar</span><span class="pun">.</span><span class="typ">Appointment@2b71e916</span><span class="pun">&gt;</span><span class="pln"> but was</span><span class="pun">:</span><span class="pln"> </span><span class="str">&lt;null&gt;</span><span class="pln">
	at org</span><span class="pun">.</span><span class="pln">junit</span><span class="pun">.</span><span class="pln">jupiter</span><span class="pun">.</span><span class="pln">api</span><span class="pun">.</span><span class="typ">AssertionUtils</span><span class="pun">.</span><span class="pln">fail</span><span class="pun">(</span><span class="typ">AssertionUtils</span><span class="pun">.</span><span class="pln">java</span><span class="pun">:</span><span class="lit">55</span><span class="pun">)</span><span class="pln">
	at org</span><span class="pun">.</span><span class="pln">junit</span><span class="pun">.</span><span class="pln">jupiter</span><span class="pun">.</span><span class="pln">api</span><span class="pun">.</span><span class="typ">AssertSame</span><span class="pun">.</span><span class="pln">failNotSame</span><span class="pun">(</span><span class="typ">AssertSame</span><span class="pun">.</span><span class="pln">java</span><span class="pun">:</span><span class="lit">48</span><span class="pun">)</span><span class="pln">
	at org</span><span class="pun">.</span><span class="pln">junit</span><span class="pun">.</span><span class="pln">jupiter</span><span class="pun">.</span><span class="pln">api</span><span class="pun">.</span><span class="typ">AssertSame</span><span class="pun">.</span><span class="pln">assertSame</span><span class="pun">(</span><span class="typ">AssertSame</span><span class="pun">.</span><span class="pln">java</span><span class="pun">:</span><span class="lit">37</span><span class="pun">)</span><span class="pln">
	at org</span><span class="pun">.</span><span class="pln">junit</span><span class="pun">.</span><span class="pln">jupiter</span><span class="pun">.</span><span class="pln">api</span><span class="pun">.</span><span class="typ">Assertions</span><span class="pun">.</span><span class="pln">assertSame</span><span class="pun">(</span><span class="typ">Assertions</span><span class="pun">.</span><span class="pln">java</span><span class="pun">:</span><span class="lit">2842</span><span class="pun">)</span><span class="pln">
	at uk</span><span class="pun">.</span><span class="pln">ac</span><span class="pun">.</span><span class="pln">aston</span><span class="pun">.</span><span class="pln">oop</span><span class="pun">.</span><span class="pln">calendar</span><span class="pun">.</span><span class="typ">DayTest</span><span class="pun">.</span><span class="pln">appointmentStartOfDay</span><span class="pun">(</span><span class="typ">DayTest</span><span class="pun">.</span><span class="pln">java</span><span class="pun">:</span><span class="lit">28</span><span class="pun">)</span><span class="pln">
	</span><span class="pun">...</span></code></pre>
<p>Look for entries that start with <code>uk.ac.aston.oop.calendar</code>: that's our code. You'll find a line like this (the exact number may change):</p>
<pre><code><span class="pln">	at uk</span><span class="pun">.</span><span class="pln">ac</span><span class="pun">.</span><span class="pln">aston</span><span class="pun">.</span><span class="pln">oop</span><span class="pun">.</span><span class="pln">calendar</span><span class="pun">.</span><span class="typ">DayTest</span><span class="pun">.</span><span class="pln">appointmentStartOfDay</span><span class="pun">(</span><span class="typ">DayTest</span><span class="pun">.</span><span class="pln">java</span><span class="pun">:</span><span class="lit">28</span><span class="pun">)</span></code></pre>
<p>That should be pointing to this check:</p>
<pre><code><span class="pln">assertSame</span><span class="pun">(</span><span class="pln">app</span><span class="pun">,</span><span class="pln"> fetched</span><span class="pun">,</span><span class="pln"> </span><span class="str">"It should be possible to fetch the appointment we just made"</span><span class="pun">);</span></code></pre>
<p>Basically, it's telling you that <code>getAppointment</code> returned <code>null</code> instead of the <code>Appointment</code> we expected. We need to fix <code>makeAppointment</code> so <code>getAppointment</code> will work.</p>
<h2 is-upgraded="">Fixing the code</h2>
<p>Add just enough code to <code>makeAppointment</code> to make this test pass. If you look at what <code>getAppointment</code> does, you'll see that you only need to store the <code>appointment</code> at the right position of the <code>appointments</code> array. Specifically, you need to store the <code>appointment</code> in the <code>time - START_OF_DAY</code> position of the <code>appointments</code> array: that means the appointment for 9 o'clock goes on the first position (position 0) and so on.</p>
<p>Once you have made the change, re-run the tests: you should now get a green bar.</p>
<p>Congratulations, you know how to do test-driven development! The rest of the lab is about writing the rest of the tests and the <code>makeAppointment</code> function.</p>


      </div></div></google-codelab-step><google-codelab-step label="Testing a bad input" duration="0" step="5" style="transform: translate3d(-110%, 0px, 0px);"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">5. Testing a bad input</h2>
        <p>Your code should not only work with good inputs, it should also handle bad inputs gracefully. Add a test method called <code>appointmentBeforeStartOfDay</code> to <code>DayTest</code>. The test method should try to make a 1-hour appointment one hour before the start of the day and try to fetch it back from the <code>Day</code>. It should then assert that the appointment was not made (<code>makeAppointment</code> returned <code>false</code>), and was not saved into the <code>Day</code> (<code>getAppointment</code> returned <code>null</code>).</p>
<p>Remember the "Arrange, Act, Assert" structure:</p>
<ul>
<li>Arrange: create a <code>Day</code> and a 1-hour <code>Appointment</code>.</li>
<li>Act: use <code>makeAppointment</code> and <code>getAppointment</code> the way you want to test them.</li>
<li>Assert: use <code>assertFalse</code> and <code>assertNull</code> to check the results. Again, you may need to <code>import</code> them (see the example in the previous section).</li>
</ul>
<p>After you have written the test, try running all tests again. You will see that the test crashes (has a red mark). Particularly, it crashes with something like this:</p>
<pre><code><span class="pln">java</span><span class="pun">.</span><span class="pln">lang</span><span class="pun">.</span><span class="typ">ArrayIndexOutOfBoundsException</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Index</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pln"> </span><span class="kwd">out</span><span class="pln"> of bounds </span><span class="kwd">for</span><span class="pln"> length </span><span class="lit">9</span><span class="pln">
	at uk</span><span class="pun">.</span><span class="pln">ac</span><span class="pun">.</span><span class="pln">aston</span><span class="pun">.</span><span class="pln">oop</span><span class="pun">.</span><span class="pln">calendar</span><span class="pun">.</span><span class="typ">Day</span><span class="pun">.</span><span class="pln">makeAppointment</span><span class="pun">(</span><span class="typ">Day</span><span class="pun">.</span><span class="pln">java</span><span class="pun">:</span><span class="lit">41</span><span class="pun">)</span><span class="pln">
	at uk</span><span class="pun">.</span><span class="pln">ac</span><span class="pun">.</span><span class="pln">aston</span><span class="pun">.</span><span class="pln">oop</span><span class="pun">.</span><span class="pln">calendar</span><span class="pun">.</span><span class="typ">DayTest</span><span class="pun">.</span><span class="pln">appointmentBeforeStartOfDay</span><span class="pun">(</span><span class="typ">DayTest</span><span class="pun">.</span><span class="pln">java</span><span class="pun">:</span><span class="lit">39</span><span class="pun">)</span><span class="pln">
	</span><span class="pun">...</span></code></pre>
<p>Look at the error message. It's saying you tried to access index -1 in this line of your <code>makeAppointment</code> function:</p>
<pre><code><span class="pln">appointments</span><span class="pun">[</span><span class="pln">time </span><span class="pun">-</span><span class="pln"> START_OF_DAY</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> appointment</span><span class="pun">;</span></code></pre>
<p>Think about it: since <code>START_OF_DAY</code> is 9 (for 9am) and you tried to run this line with <code>time</code> equal to 8, then this line will try to access position <code>8 - 9 = -1</code>. That is not a valid position in an array.</p>
<p>Fix the problem in <code>makeAppointment</code> by adding a check that the <code>time</code> is valid (use <code>validTime</code>): if it is not valid, return <code>false</code> without doing anything.</p>
<p>Now, re-run your tests: everything should be green again. Keep in mind what this means: at the same time you are writing your function, you are writing tests that ensure that the things that used to work still work. This can be very useful as you consider more and more cases for that function.</p>


      </div></div></google-codelab-step><google-codelab-step label="Avoiding double-booking" duration="0" step="6" style="transform: translate3d(110%, 0px, 0px);"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">6. Avoiding double-booking</h2>
        <p>We need to avoid booking the same hour twice in a day. Add a test method to <code>DayTest</code> called <code>twoAppsOnSameTime</code>. This test should try to book two different appointments on the same hour: the first one should go through, and the second one should not.</p>
<p>The same structure applies:</p>
<ul>
<li>Arrange: create a <code>Day</code> and two different 1-hour <code>Appointment</code>s: call them <code>appA</code> and <code>appB</code>.</li>
<li>Act: make the <code>appA</code> appointment (store the result into <code>successA</code>) and use <code>getAppointment</code> to fetch it into <code>fetchedA</code>, then try to make the <code>appB</code> appointment on the same time (store the result into <code>successB</code>) and use <code>getAppointment</code> to fetch the appointment at that time into <code>fetchedB</code>.</li>
<li>Assert: use <code>assertTrue</code>, <code>assertFalse</code>, and <code>assertSame</code> to check several things. <code>successA</code> should be <code>true</code> (making an appointment in an empty slot should work), <code>fetchedA</code> should be the same as <code>appA</code> (the expected appointment was fetched back from the Day at the expected time), <code>successB</code> should be <code>false</code> (making an appointment in an occupied slot should not work), and <code>fetchedB</code><em>should be the same as </em><code>appA</code> again (the second appointment did <em>not</em> overwrite the existing one).</li>
</ul>
<p>Re-run your tests, and you will be failing the new test here:</p>
<pre><code><span class="pln">org</span><span class="pun">.</span><span class="pln">opentest4j</span><span class="pun">.</span><span class="typ">AssertionFailedError</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Making</span><span class="pln"> an appt </span><span class="kwd">in</span><span class="pln"> an occupied slot should </span><span class="kwd">not</span><span class="pln"> work </span><span class="pun">==&gt;</span><span class="pln"> expected</span><span class="pun">:</span><span class="pln"> </span><span class="str">&lt;false&gt;</span><span class="pln"> but was</span><span class="pun">:</span><span class="pln"> </span><span class="str">&lt;true&gt;</span><span class="pln">
	at org</span><span class="pun">.</span><span class="pln">junit</span><span class="pun">.</span><span class="pln">jupiter</span><span class="pun">.</span><span class="pln">api</span><span class="pun">.</span><span class="typ">AssertionUtils</span><span class="pun">.</span><span class="pln">fail</span><span class="pun">(</span><span class="typ">AssertionUtils</span><span class="pun">.</span><span class="pln">java</span><span class="pun">:</span><span class="lit">55</span><span class="pun">)</span><span class="pln">
	at org</span><span class="pun">.</span><span class="pln">junit</span><span class="pun">.</span><span class="pln">jupiter</span><span class="pun">.</span><span class="pln">api</span><span class="pun">.</span><span class="typ">AssertFalse</span><span class="pun">.</span><span class="pln">assertFalse</span><span class="pun">(</span><span class="typ">AssertFalse</span><span class="pun">.</span><span class="pln">java</span><span class="pun">:</span><span class="lit">40</span><span class="pun">)</span><span class="pln">
	at org</span><span class="pun">.</span><span class="pln">junit</span><span class="pun">.</span><span class="pln">jupiter</span><span class="pun">.</span><span class="pln">api</span><span class="pun">.</span><span class="typ">Assertions</span><span class="pun">.</span><span class="pln">assertFalse</span><span class="pun">(</span><span class="typ">Assertions</span><span class="pun">.</span><span class="pln">java</span><span class="pun">:</span><span class="lit">218</span><span class="pun">)</span><span class="pln">
	at uk</span><span class="pun">.</span><span class="pln">ac</span><span class="pun">.</span><span class="pln">aston</span><span class="pun">.</span><span class="pln">oop</span><span class="pun">.</span><span class="pln">calendar</span><span class="pun">.</span><span class="typ">DayTest</span><span class="pun">.</span><span class="pln">twoAppsOnSameTime</span><span class="pun">(</span><span class="typ">DayTest</span><span class="pun">.</span><span class="pln">java</span><span class="pun">:</span><span class="lit">60</span><span class="pun">)</span><span class="pln">
    </span><span class="pun">...</span></code></pre>
<p>Look at the error message, and think about how you can fix <code>makeAppointment</code> to pass the test. In addition to checking that the starting time is valid, you need to check that the position in the <code>appointments</code> array is not taken (it should be <code>== null</code>). Fix the code and re-run your tests.</p>


      </div></div></google-codelab-step><google-codelab-step label="Multiple-hour appointments" duration="0" step="7"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">7. Multiple-hour appointments</h2>
        <p>With the above tests, we should have 1-hour appointments working. We need to add tests to handle appointments that last longer than one hour. Add test methods to <code>DayTest</code> for the situations below, and fix your <code>makeAppointment</code> function to pass them:</p>
<ul>
<li><code>twoHourAppointmentAtStart</code>: We should be able to make a 2-hour appointment right at the beginning of the day (say, 9-11). We should get back the same 2-hour appointment if we ask for the appointment at 9 o'clock and for the appointment at 10 o'clock.</li>
<li><code>twoHourAppointmentBeyondEnd</code>: We should NOT be able to make a 2-hour appointment that goes beyond the end of the day (17-19), as the last hour available to make appointments is 17-18 (since <code>Day.FINAL_APPOINTMENT_TIME</code> is 17). That means that <code>makeAppointment</code> should return <code>false</code>, and we should be getting <code>null</code> from calling <code>getAppointment</code> at 5pm and at 6pm.</li>
<li><code>overlappingTwoHourAppointments</code>: After booking a 2-hour slot (say, 11-13), we should not be able to book an overlapping 2-hour slot (for example, 10-12 or 13-15).</li>
</ul>
<p>Don't try to write all tests at once: write the first test, ensure it fails where you expected it, fix the code, and then check it passes. Follow the usual "Arrange, Act, Assert" structure that you have seen in the previous examples.</p>
<p>Tips:</p>
<ul>
<li>For fixing the code to pass <code>twoHourAppointmentAtStart</code>, you will need to update all the relevant positions on the <code>appointments</code> array, not just one as before.</li>
<li>For fixing the code to pass <code>twoHourAppointmentBeyondEnd</code>, you will have to test that the last hour of the appointment is a valid time to be booked as well, and not just the first hour.</li>
<li>For fixing the code to pass <code>overlappingTwoHourAppointments</code>, you will want to first ensure all the relevant positions in <code>appointments</code> are not taken yet (they are still <code>null</code>), <em>before</em> you change any of their values. You might want to have a first loop do this check, and if it is OK to book then have a second loop change the relevant values in <code>appointments</code>.</li>
</ul>


      </div></div></google-codelab-step><google-codelab-step label="Submitting to AutoFeedback and Blackboard" duration="0" step="8"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">8. Submitting to AutoFeedback and Blackboard</h2>
        <p>In term 2, we will be using tests to mark your lab submissions, which will count towards your continuous assessment mark. The tests for this lab will be similar to those that you have written yourself.</p>
<p>This year, we are piloting <a href="https://autofeedback.cs2410-web01pvm.aston.ac.uk/login" target="_blank">AutoFeedback</a>, a system we have created to allow you to get automated feedback on your submission before you upload it to Blackboard. AutoFeedback will try to compile your Java code and run a test suite that we have designed for each lab, and will tell you if your code is invalid or if you do not pass one of your tests. You can submit to AutoFeedback as many times as you like, but keep in mind that the ZIP which counts for marks is the last one you uploaded to Blackboard before the deadline. Please keep in mind that as it is the first year we use AutoFeedback, there may be some teething issues: please report them to Antonio and we will look into them as soon as possible. If AutoFeedback is down close to a deadline and you need to submit, you can ZIP the code yourself and upload it to Blackboard while we fix the issue.</p>
<p>The general steps for using AutoFeedback are explained in the lecture slides for Week 1. First, right-click on the <code>Submit to AutoFeedback.launch</code> file in the project and select <code>Run As - Submit to AutoFeedback</code>:</p>
<p class="image-container"><img alt="AutoFeedback submission" src="./CS1OOP Lab 1 (TDD with AutoFeedback)_files/9b36766a7e6ddab3.png"></p>
<aside class="warning"><p>If you look at the Console view, you will see some warnings about "SLF4J" (for example, "SLF4J: Class path contains multiple SLF4J bindings"). You can safely ignore them. These are from a minor <a href="https://bugs.eclipse.org/bugs/show_bug.cgi?id=506676" target="_blank">known issue</a> in the current version of the integration between Maven and Eclipse, and have nothing to do with your submission. They will be fixed at some point by the Eclipse developers.</p>
</aside>
<p>This will create a <code>submission.zip</code> file with your code inside your Eclipse project, and then upload that to the AutoFeedback webapp. If this is your first time using AutoFeedback in your computer, you will be asked to authenticate to create a personal access token:</p>
<p class="image-container"><img alt="AutoFeedback personal access token" src="./CS1OOP Lab 1 (TDD with AutoFeedback)_files/67ed33b02270f1af.png"></p>
<p>The token name will be filled in with the name of your computer: using the default should usually be fine. Use your Aston email address and your Aston password for the other fields, and click on "Create Token". Once the token has been created, your ZIP will be added to the queue in AutoFeedback. Your default web browser will open your submission in AutoFeedback. If this is your first time using the AutoFeedback website, you will see the login form:</p>
<p class="image-container"><img alt="AutoFeedback login form" src="./CS1OOP Lab 1 (TDD with AutoFeedback)_files/e91f267864f00443.png"></p>
<p>Use your Aston email address and password. Once you are in, you will see your submission and its current status:</p>
<p class="image-container"><img alt="AutoFeedback submission status" src="./CS1OOP Lab 1 (TDD with AutoFeedback)_files/3cd9066f5b4f770f.png"></p>
<p>It will start on "Pending", then change to "Running" after it reaches the front of the queue, and then finish as "Completed" or "Failed". You should normally not need to reload the page: it will be updated automatically. After a few minutes, you will see that it is updated with a summary of your results:</p>
<p class="image-container"><img alt="AutoFeedback submission summary" src="./CS1OOP Lab 1 (TDD with AutoFeedback)_files/5411ad56cfa8ada0.png"></p>
<p>You can also scroll down and see which tests you passed or failed. Keep in mind these tests may be different from the ones you see in the screenshot below:</p>
<p class="image-container"><img alt="AutoFeedback test details" src="./CS1OOP Lab 1 (TDD with AutoFeedback)_files/d0e09078521210d8.png"></p>
<p>If you see any failed/missing tests, look at the feedback, review your tests (you may need more!), fix your code, and resubmit. If you need more detailed information, you can click on the <code>submission.zip</code> link and check the build job details:</p>
<p class="image-container"><img alt="AutoFeedback job details" src="./CS1OOP Lab 1 (TDD with AutoFeedback)_files/3b3920414bc305d5.png"></p>
<p>From that page, you can click on <code>/stdout.txt</code> to see the output of the program (which includes detailed error messages for each test), like this one:</p>
<p class="image-container"><img alt="AutoFeedback build log" src="./CS1OOP Lab 1 (TDD with AutoFeedback)_files/264ab06fa0489d75.png"></p>
<p>In any case, once AutoFeedback reports that your submission passes all the test cases, you can upload the <code>submission.zip</code> file in your project to Blackboard. Good job!</p>


      </div></div></google-codelab-step></div><div id="controls"><div id="fabs"><a href="https://vle.aston.ac.uk/bbcswebdav/pid-2151616-dt-content-rid-14503049_1/courses/2020_CS1OOP_P1_P2/TP2/week01-tdd-autofeedback/cs1oop-tdd-autofeedback/index.html#" id="previous-step" title="Previous step" disappear="">Back</a><div class="spacer"></div><a href="https://vle.aston.ac.uk/bbcswebdav/pid-2151616-dt-content-rid-14503049_1/courses/2020_CS1OOP_P1_P2/TP2/week01-tdd-autofeedback/cs1oop-tdd-autofeedback/index.html#" id="next-step" title="Next step">Next</a><a href="https://vle.aston.ac.uk/" id="done" hidden="" title="Codelab complete">Done</a></div></div></div></google-codelab>

  <script src="./CS1OOP Lab 1 (TDD with AutoFeedback)_files/native-shim.js.download"></script>
  <script src="./CS1OOP Lab 1 (TDD with AutoFeedback)_files/custom-elements.min.js.download"></script>
  <script src="./CS1OOP Lab 1 (TDD with AutoFeedback)_files/prettify.js.download"></script>
  <script src="./CS1OOP Lab 1 (TDD with AutoFeedback)_files/codelab-elements.js.download"></script>
  <script src="./CS1OOP Lab 1 (TDD with AutoFeedback)_files/api.js.download"></script>



</body></html>